<%= render partial: "caching" %>
<p class="text-muted" style="margin-bottom: 10px;">
  <%= pluralize(@rows.size, "cohort") %>
</p>
<table class="table results-table">
  <thead>
    <tr>
      <th>Cohort</th>
      <th style="width: 6.5%; text-align: right;">Users</th>
      <% 12.times do |i| %>
        <th style="width: 6.5%; text-align: right;"><%= i + 1 %></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @rows.zip(@cohort_dates) do |row, date| %>
      <tr>
        <td><%= row[0] %></td>
        <td style="text-align: right;"><%= row[1] %></td>
        <% 12.times do |i| %>
          <td style="text-align: right;">
            <% num = row[i + 2] %>
            <% if num %>
              <% denom = @buckets[[date, 0]] || 0 %>
              <% if denom > 0 #&& today > current_date + (7 * (j + 1)) %>
                <%= (100.0 * num / denom).round %>%
              <% else %>
                -
              <% end %>
              <div style="font-size: 12px; color: #999;"><%= num %></div>
            <% else %>
              -
            <% end %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
